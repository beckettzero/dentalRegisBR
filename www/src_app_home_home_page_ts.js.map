{"version":3,"file":"src_app_home_home_page_ts.js","mappings":";;;;;;;;;;;;;;;;;;;;;;AACyF;AAG1C;AACkC;;;;;;AAS3E,MAAOI,QAAQ;EAOnBC,YAAoBC,EAAe,EAAUC,MAAc,EAAUC,IAAgB,EAASC,WAA8B;IAAxG,KAAAH,EAAE,GAAFA,EAAE;IAAuB,KAAAC,MAAM,GAANA,MAAM;IAAkB,KAAAC,IAAI,GAAJA,IAAI;IAAqB,KAAAC,WAAW,GAAXA,WAAW;IACvG,IAAI,CAACC,SAAS,GAAG,IAAI,CAACJ,EAAE,CAACK,KAAK,CAAC;MAC7BC,QAAQ,EAAE,CAAC,EAAE,EAAEX,sDAAU,CAACY,QAAQ,CAAC;MACnCC,QAAQ,EAAE,CAAC,EAAE,EAAEb,sDAAU,CAACY,QAAQ;KACnC,CAAC;EACJ;EAEME,WAAWA,CAAA;IAAA,IAAAC,KAAA;IAAA,OAAAC,mLAAA;MACf,MAAMC,OAAO,SAASF,KAAI,CAACP,WAAW,CAACU,MAAM,CAAC;QAC5CC,OAAO,EAAE,gBAAgB;QACzBC,QAAQ,EAAE;OACX,CAAC;MAEFH,OAAO,CAACI,OAAO,EAAE;IAAC;EACpB;EAEAC,QAAQA,CAAA;IACN,IAAI,CAACC,oBAAoB,EAAE;IAC3B,IAAI,CAACC,wBAAwB,EAAE;EACjC;EAEA;EACkCC,WAAWA,CAAA;IAC3C,IAAI,CAACF,oBAAoB,EAAE;EAC7B;EAEmCG,YAAYA,CAAA;IAC7C,IAAI,CAACH,oBAAoB,EAAE;EAC7B;EAEgCI,SAASA,CAAA;IACvC,IAAI,CAACJ,oBAAoB,EAAE;EAC7B;EAE8BK,OAAOA,CAAA;IACnC,IAAI,CAACL,oBAAoB,EAAE;EAC7B;EAEAM,QAAQA,CAAA;IACN,IAAI,IAAI,CAACpB,SAAS,CAACqB,KAAK,EAAE;MACxB,MAAMnB,QAAQ,GAAG,IAAI,CAACF,SAAS,CAACsB,GAAG,CAAC,UAAU,CAAE,CAACC,KAAK;MACtD,MAAMnB,QAAQ,GAAG,IAAI,CAACJ,SAAS,CAACsB,GAAG,CAAC,UAAU,CAAE,CAACC,KAAK;MAEtD,IAAI,CAACzB,IAAI,CAAC0B,IAAI,CAAM,8CAA8C,EAAE;QAAEtB,QAAQ;QAAEE;MAAQ,CAAE,CAAC,CAACqB,SAAS,CAACC,QAAQ,IAAG;QAC/G,IAAIA,QAAQ,CAACC,MAAM,KAAK,SAAS,EAAE;UACjC;UACAC,YAAY,CAACC,OAAO,CAAC,YAAY,EAAE,MAAM,CAAC;UAC1CD,YAAY,CAACC,OAAO,CAAC,YAAY,EAAEH,QAAQ,CAACI,UAAU,CAAC,CAAC,CAAC;UACzD,IAAI,CAACjC,MAAM,CAACkC,QAAQ,CAAC,CAAC,QAAQ,CAAC,CAAC;UAChC,IAAI,CAACjB,oBAAoB,EAAE;QAC7B,CAAC,MAAM;UACLkB,KAAK,CAAC,qBAAqB,CAAC;QAC9B;MACF,CAAC,CAAC;IACJ;EACF;EAEAlB,oBAAoBA,CAAA;IAClB,IAAI,IAAI,CAACmB,eAAe,EAAE;MACxBC,YAAY,CAAC,IAAI,CAACD,eAAe,CAAC;IACpC;IAEA,IAAI,CAACA,eAAe,GAAGE,UAAU,CAAC,MAAK;MACrC,IAAI,CAACC,MAAM,EAAE;IACf,CAAC,EAAE,KAAK,CAAC,CAAC,CAAC;EACb;EAEAA,MAAMA,CAAA;IACJR,YAAY,CAACS,UAAU,CAAC,YAAY,CAAC;IACrC,IAAI,CAACxC,MAAM,CAACkC,QAAQ,CAAC,CAAC,GAAG,CAAC,CAAC;IAC3BC,KAAK,CAAC,oCAAoC,CAAC;EAC7C;EAEAjB,wBAAwBA,CAAA;IACtB;IACA,IAAI,CAACC,WAAW,EAAE;IAClB,IAAI,CAACC,YAAY,EAAE;IACnB,IAAI,CAACC,SAAS,EAAE;IAChB,IAAI,CAACC,OAAO,EAAE;EAChB;;YAtFWzB,QAAQ;;mCAARA,SAAQ,EAAA4C,+DAAA,CAAAE,uDAAA,GAAAF,+DAAA,CAAAI,mDAAA,GAAAJ,+DAAA,CAAAM,4DAAA,GAAAN,+DAAA,CAAAQ,6DAAA;AAAA;;QAARpD,SAAQ;EAAAsD,SAAA;EAAAC,YAAA,WAAAC,sBAAAC,EAAA,EAAAC,GAAA;IAAA,IAAAD,EAAA;MAARb,wDAAA,uBAAAgB,sCAAA;QAAA,OAAAF,GAAA,CAAApC,WAAA,EAAa;MAAA,UAAAsB,6DAAA,CAAL,wBAAAkB,uCAAA;QAAA,OAARJ,GAAA,CAAAnC,YAAA,EAAc;MAAA,UAAAqB,6DAAA,CAAN,qBAAAmB,oCAAA;QAAA,OAARL,GAAA,CAAAlC,SAAA,EAAW;MAAA,UAAAoB,6DAAA,CAAH,mBAAAoB,kCAAA;QAAA,OAARN,GAAA,CAAAjC,OAAA,EAAS;MAAA,UAAAmB,6DAAA,CAAD;;;;;;;;;;MCbnBA,4DADF,qBAAqD,aACrB;MAC5BA,uDAAA,aAAmF;MACrFA,0DAAA,EAAM;MAIFA,4DAFJ,aAA6D,kBACzB,cACsB;MAAxBA,wDAAA,sBAAAwB,2CAAA;QAAA,OAAYV,GAAA,CAAAhC,QAAA,EAAU;MAAA,EAAC;MACnDkB,4DAAA,kBAAoC;MAClCA,uDAAA,mBAAmI;MACrIA,0DAAA,EAAW;MAEXA,4DAAA,kBAAoC;MAClCA,uDAAA,mBAAqI;MACvIA,0DAAA,EAAW;MAEXA,4DAAA,qBAAyI;MAA7HA,wDAAA,mBAAAyB,+CAAA;QAAA,OAASX,GAAA,CAAA/C,WAAA,EAAa;MAAA,EAAC;MACjCiC,oDAAA,kBACF;MAGNA,0DAHM,EAAa,EACR,EACE,EACP;MAGJA,4DADF,WAAK,sBAC0E;MAC3EA,oDAAA,iDACF;MAEJA,0DAFI,EAAa,EACT,EACM;;;MA5BDA,wDAAA,oBAAmB;MAOpBA,uDAAA,GAAuB;MAAvBA,wDAAA,cAAAc,GAAA,CAAApD,SAAA,CAAuB;MASsCsC,uDAAA,GAA6B;MAA7BA,wDAAA,cAAAc,GAAA,CAAApD,SAAA,CAAAqB,KAAA,CAA6B;;;iBDJ1F7B,yDAAY,EAAEF,+DAAmB,EAAAkD,4DAAA,EAAAA,2DAAA,EAAAA,gEAAA,EAAAA,8DAAA,EAAAA,2DAAA,EAAE/C,uDAAW,EAAAqD,qDAAA,EAAAA,mDAAA,EAAAA,sDAAA,EAAAA,oDAAA,EAAAA,mDAAA,EAAAA,6DAAA,EAAAA,8DAAA;EAAAiC,MAAA;AAAA","sources":["./src/app/home/home.page.ts","./src/app/home/home.page.html"],"sourcesContent":["import { Component, OnInit, HostListener } from '@angular/core';\nimport { FormBuilder, FormGroup, ReactiveFormsModule, Validators } from '@angular/forms';\nimport { Router } from '@angular/router';\nimport { HttpClient } from '@angular/common/http';\nimport { CommonModule } from '@angular/common';\nimport { IonicModule, LoadingController, ToastController } from '@ionic/angular';\n\n@Component({\n  selector: 'app-home',\n  templateUrl: 'home.page.html',\n  styleUrls: ['home.page.scss'],\n  standalone: true,\n  imports: [CommonModule, ReactiveFormsModule, IonicModule]\n})\nexport class HomePage implements OnInit {\n  loginForm: FormGroup;\n  inactivityTimer: any;\n  showToast: any;\n  toastMessage: any;\n  toastColor: any;\n\n  constructor(private fb: FormBuilder, private router: Router, private http: HttpClient,private loadingCtrl: LoadingController) {\n    this.loginForm = this.fb.group({\n      username: ['', Validators.required],\n      password: ['', Validators.required],\n    });\n  }\n\n  async showLoading() {\n    const loading = await this.loadingCtrl.create({\n      message: 'Comprobando...',\n      duration: 3000,\n    });\n\n    loading.present();\n  }\n\n  ngOnInit() {\n    this.resetInactivityTimer();\n    this.setupInactivityListeners();\n  }\n\n  // Manejadores para diferentes eventos de interacción\n  @HostListener('window:mousemove') onMouseMove() {\n    this.resetInactivityTimer();\n  }\n\n  @HostListener('window:touchstart') onTouchStart() {\n    this.resetInactivityTimer();\n  }\n\n  @HostListener('window:keydown') onKeyDown() {\n    this.resetInactivityTimer();\n  }\n\n  @HostListener('window:click') onClick() {\n    this.resetInactivityTimer();\n  }\n\n  onSubmit() {\n    if (this.loginForm.valid) {\n      const username = this.loginForm.get('username')!.value;\n      const password = this.loginForm.get('password')!.value;\n  \n      this.http.post<any>('https://www.dentalregisbr.000.pe/loginDB.php', { username, password }).subscribe(response => {\n        if (response.status === 'success') {\n          // Aquí asumo que `response.usuario_id` es el ID del usuario que viene desde el backend.\n          localStorage.setItem('isLoggedIn', 'true');\n          localStorage.setItem('usuario_id', response.usuario_id); // Guarda el usuario_id en localStorage\n          this.router.navigate(['/menu1']);\n          this.resetInactivityTimer();\n        } else {\n          alert('Invalid credentials');\n        }\n      });\n    }\n  }\n  \n  resetInactivityTimer() {\n    if (this.inactivityTimer) {\n      clearTimeout(this.inactivityTimer);\n    }\n\n    this.inactivityTimer = setTimeout(() => {\n      this.logout();\n    }, 60000); // 10 segundos\n  }\n\n  logout() {\n    localStorage.removeItem('isLoggedIn');\n    this.router.navigate(['/']);\n    alert('Session expired due to inactivity.');\n  }\n\n  setupInactivityListeners() {\n    // Se asegura de que se reinicie el timer para cualquier interacción\n    this.onMouseMove();\n    this.onTouchStart();\n    this.onKeyDown();\n    this.onClick();\n  }\n}\n","<ion-content [fullscreen]=\"true\" class=\"ion-padding\">\n  <div class=\"center-container\">\n    <img src=\"/assets/img/dental-logo.webp\" alt=\"dentalink logo\" style=\"width: 200px;\">\n  </div>\n\n  <div id=\"login-container\" class=\"ion-margin-top ion-padding\">\n    <ion-card class=\"ion-text-center\">\n      <form [formGroup]=\"loginForm\" (ngSubmit)=\"onSubmit()\">\n        <ion-item class=\"ion-margin-bottom\">\n          <ion-input  label=\"Usuario\" label-placement=\"floating\" fill=\"solid\" formControlName=\"username\" type=\"text\" clear-input></ion-input>\n        </ion-item>\n\n        <ion-item class=\"ion-margin-bottom\">\n          <ion-input  label=\"Clave\" label-placement=\"floating\" fill=\"solid\" formControlName=\"password\" type=\"password\" clear-input></ion-input>\n        </ion-item>\n\n        <ion-button (click)=\"showLoading()\" expand=\"block\" type=\"submit\" [disabled]=\"!loginForm.valid\" color=\"success\" style=\"margin-top: 20px;\">\n          Ingresar\n        </ion-button>\n      </form>\n    </ion-card>\n  </div>\n\n  <div>\n    <ion-button expand=\"block\" fill=\"clear\" color=\"light\" routerLink=\"/register\">\n      ¿No tienes cuenta? Regístrate\n    </ion-button>\n  </div>\n</ion-content>\n"],"names":["ReactiveFormsModule","Validators","CommonModule","IonicModule","HomePage","constructor","fb","router","http","loadingCtrl","loginForm","group","username","required","password","showLoading","_this","_asyncToGenerator","loading","create","message","duration","present","ngOnInit","resetInactivityTimer","setupInactivityListeners","onMouseMove","onTouchStart","onKeyDown","onClick","onSubmit","valid","get","value","post","subscribe","response","status","localStorage","setItem","usuario_id","navigate","alert","inactivityTimer","clearTimeout","setTimeout","logout","removeItem","i0","ɵɵdirectiveInject","i1","FormBuilder","i2","Router","i3","HttpClient","i4","LoadingController","selectors","hostBindings","HomePage_HostBindings","rf","ctx","ɵɵlistener","HomePage_mousemove_HostBindingHandler","ɵɵresolveWindow","HomePage_touchstart_HostBindingHandler","HomePage_keydown_HostBindingHandler","HomePage_click_HostBindingHandler","ɵɵelementStart","ɵɵelement","ɵɵelementEnd","HomePage_Template_form_ngSubmit_5_listener","HomePage_Template_ion_button_click_10_listener","ɵɵtext","ɵɵproperty","ɵɵadvance","ɵNgNoValidate","NgControlStatus","NgControlStatusGroup","FormGroupDirective","FormControlName","IonButton","IonCard","IonContent","IonInput","IonItem","TextValueAccessor","RouterLinkDelegate","styles"],"sourceRoot":"webpack:///","x_google_ignoreList":[]}